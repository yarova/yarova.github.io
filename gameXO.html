<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>XO</title>
    <link href="styles/gameXO.css" type="text/css" rel="stylesheet"/>
    <link rel="icon" href="images/camomile.png" type="image/x-icon">
    <script type="text/javascript" src="js/jquery-1.11.0.min.js"></script>
</head>
<body>
<script type="text/javascript">
    /*$(function(){


        function game(){
            var cubes = ['c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9'];
            var html = '';
            var cubesId = 'id="' + cubes[i] + '">';
            for (var i = 0; i < cubes.length; i++){
                html = html + '<div class="leftCube cube" ' + cubesId + '</div><div class="rightCube cube" ' + cubesId + '</div><div class="centerCube cube" ' + cubesId + '</div>';

                            //+ '<div class="leftCube cube" id="' + cubes[i] + '"></div>'
                            //+ '<div class="rightCube cube" id="' + cubes[i] + '"></div>'
                            //+ '<div class="centerCube cube" id="' + cubes[i] + '"></div>';
            }
            $('#center').html(html);
        }
    }); */


    $(function(){

        var isCross = true;

        $('.cube').on('click', function(){
            var hasCrossClass = $(this).hasClass('cross'),
                hasZeroClass = $(this).hasClass('zero');

            if (hasCrossClass || hasZeroClass){
                return;
            }

            if (isCross){
                $(this).addClass('cross');
                isCross = false;
            } else {
                $(this).addClass('zero');
                isCross = true;
            }
            checkWinner();
        });

        $('#button').on('click', function(){
            if ($('.cube').hasClass('cross') || $('.cube').hasClass('zero')){
                removeClasses();
                $('.whiteFlower').toggleClass('redFlower');
                //changeColorFlower();
                $('#center').css({ visibility: 'visible' });
            }
        });

        /*function changeColorFlower(){
            if ($('.petal').hasClass('whiteFlower')){
                $('.petal').removeClass('whiteFlower');
                $('.petal').addClass('redFlower');
            }
            else if ($('.petal').hasClass('whiteFlower') && $('.petal').hasClass('redFlower')){
                $('.petal').removeClass('redFlower');
            }
        } */

        function removeClasses() {
            $('.cube').removeClass('cross');
            $('.cube').removeClass('zero');
            $('body').removeClass('winnerCat');
            $('body').removeClass('winnerDog');
            $('.wrapPetal').removeClass('rollingFlower');
        }

        function showAnimalScreen (){
            $('.whiteFlower').toggleClass('redFlower');
            $('.wrapPetal').addClass('rollingFlower');
            $('#center').css({ visibility: 'hidden' });
        }

        function showCatScreen (){
            $('body').addClass('winnerCat');
            showAnimalScreen ();
        }

        function showDogScreen (){
            $('body').addClass('winnerDog');
            showAnimalScreen ();
        }

        function elementsHasClass ($cube1, $cube2, $cube3, cssClass){
            if($cube1.hasClass(cssClass) && $cube2.hasClass(cssClass) && $cube3.hasClass(cssClass)){
                return true;
            } else {
                return false;
            }
        }

        function hasWinLineWithClass (cssClass){
            var hasLine =   elementsHasClass ($('#c1'), $('#c2'), $('#c3'), cssClass) ||
                            elementsHasClass ($('#c4'), $('#c5'), $('#c6'), cssClass) ||
                            elementsHasClass ($('#c7'), $('#c8'), $('#c9'), cssClass) ||

                            elementsHasClass ($('#c1'), $('#c4'), $('#c7'), cssClass) ||
                            elementsHasClass ($('#c3'), $('#c6'), $('#c9'), cssClass) ||
                            elementsHasClass ($('#c2'), $('#c5'), $('#c8'), cssClass) ||

                            elementsHasClass ($('#c1'), $('#c6'), $('#c8'), cssClass) ||
                            elementsHasClass ($('#c2'), $('#c6'), $('#c7'), cssClass);
            return hasLine;
        }

        function checkWinner(){
            if (hasWinLineWithClass('cross'))  {
                alert('Победил крестик :)');
                showCatScreen();
            }
            else if(hasWinLineWithClass('zero')) {
                alert('Победил нолик :)');
                showDogScreen();
            }
        };
    });


</script>
<div class="pageWrapper">
    <div id="center">
        <div class="leftCube cube" id="c1"></div>
        <div class="rightCube cube" id="c2"></div>
        <div class="centerCube cube" id="c3"></div>

        <div class="leftCube cube" id="c4"></div>
        <div class="rightCube cube" id="c5"></div>
        <div class="centerCube cube" id="c6"></div>

        <div class="leftCube cube" id="c7"></div>
        <div class="rightCube cube" id="c8"></div>
        <div class="centerCube cube" id="c9"></div>
    </div>

    <!--<div id="message"></div>-->

    <div class="wrapPetal">
        <div class="petal whiteFlower"></div>
        <button id="button" type="button">Again</button>
    </div>
</div>





</body>
</html>